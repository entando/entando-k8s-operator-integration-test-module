buildPack: entando-maven-docker
pipelineConfig:
  env:
    - name: PIPELINE_CODE
      value: dj
    - name: TEST_DEPLOYMENT
      value: "true"
    - name: UPDATE_OWASP_DB
      value: "false"
    - name: ENTANDO_DOCKER_IMAGE_INFO_CONFIGMAP
      value: "entando-docker-image-info-v6.1"
    - name: EXECUTABLE_TYPE
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: executable.type
    - name: MYSQL_ADMIN_PASSWORD
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: mysql.admin.password
    - name: MYSQL_ADMIN_USER
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: mysql.admin.user
    - name: ORACLE11_ADMIN_USER
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: oracle11.admin.user
    - name: ORACLE11_ADMIN_PASSWORD
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: oracle11.admin.password
    - name: ORACLE11_DATABASE_NAME
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: oracle11.database.name
    - name: ORACLE12_ADMIN_USER
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: oracle12.admin.user
    - name: ORACLE12_ADMIN_PASSWORD
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: oracle12.admin.password
    - name: ORACLE12_DATABASE_NAME
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: oracle12.database.name
    - name: POSTGRESQL_ADMIN_USER
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: postgresql.admin.user
    - name: POSTGRESQL_ADMIN_PASSWORD
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: postgresql.admin.password
    - name: POSTGRESQL_DATABASE_NAME
      valueFrom:
        secretKeyRef:
          name: entando-jx-common-secret
          key: postgresql.database.name
  pipelines:
    release:
      promote:
        replace: true
        steps:
          - sh: publish-image-info
            name: update-image-map